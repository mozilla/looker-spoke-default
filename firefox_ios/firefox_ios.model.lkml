connection: "telemetry"
label: "Firefox for iOS"


# TODO: remove unnecessary view imports
include: "//looker-hub/firefox_ios/views/active_users_aggregates_table.view.lkml"
include: "//looker-hub/firefox_ios/views/active_users_table.view.lkml"
include: "//looker-hub/firefox_ios/views/ad_activation_performance_table.view.lkml"
include: "//looker-hub/firefox_ios/views/app_store_funnel_table.view.lkml"
include: "//looker-hub/firefox_ios/views/attributable_clients_table.view.lkml"
include: "//looker-hub/firefox_ios/views/attribution_clients_table.view.lkml"
include: "//looker-hub/firefox_ios/views/baseline.view.lkml"
include: "//looker-hub/firefox_ios/views/baseline_clients_daily.view.lkml"
include: "//looker-hub/firefox_ios/views/baseline_clients_daily_table.view.lkml"
include: "//looker-hub/firefox_ios/views/baseline_clients_first_seen.view.lkml"
include: "//looker-hub/firefox_ios/views/baseline_clients_first_seen_table.view.lkml"
include: "//looker-hub/firefox_ios/views/baseline_clients_last_seen.view.lkml"
include: "//looker-hub/firefox_ios/views/baseline_clients_last_seen_table.view.lkml"
include: "//looker-hub/firefox_ios/views/baseline_clients_yearly_table.view.lkml"
include: "//looker-hub/firefox_ios/views/baseline_table.view.lkml"
include: "//looker-hub/firefox_ios/views/bookmarks_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/bookmarks_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/client_counts.view.lkml"
include: "//looker-hub/firefox_ios/views/client_ltv_table.view.lkml"
include: "//looker-hub/firefox_ios/views/clients_activation.view.lkml"
include: "//looker-hub/firefox_ios/views/clients_activation_table.view.lkml"
include: "//looker-hub/firefox_ios/views/clients_last_seen_joined_table.view.lkml"
include: "//looker-hub/firefox_ios/views/column_field_paths.view.lkml"
include: "//looker-hub/firefox_ios/views/creditcards_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/creditcards_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/deletion_request.view.lkml"
include: "//looker-hub/firefox_ios/views/deletion_request_table.view.lkml"
include: "//looker-hub/firefox_ios/views/engagement_clients_table.view.lkml"
include: "//looker-hub/firefox_ios/views/engagement_table.view.lkml"
include: "//looker-hub/firefox_ios/views/events.view.lkml"
include: "//looker-hub/firefox_ios/views/events_stream.view.lkml"
include: "//looker-hub/firefox_ios/views/events_stream_table.view.lkml"
include: "//looker-hub/firefox_ios/views/events_table.view.lkml"
include: "//looker-hub/firefox_ios/views/events_unnested.view.lkml"
include: "//looker-hub/firefox_ios/views/events_unnested_table.view.lkml"
include: "//looker-hub/firefox_ios/views/feature_usage_events.view.lkml"
include: "//looker-hub/firefox_ios/views/feature_usage_events_table.view.lkml"
include: "//looker-hub/firefox_ios/views/feature_usage_metrics.view.lkml"
include: "//looker-hub/firefox_ios/views/feature_usage_metrics_table.view.lkml"
include: "//looker-hub/firefox_ios/views/firefox_ios_clients.view.lkml"
include: "//looker-hub/firefox_ios/views/firefox_ios_clients_table.view.lkml"
include: "//looker-hub/firefox_ios/views/first_session.view.lkml"
include: "//looker-hub/firefox_ios/views/first_session_table.view.lkml"
include: "//looker-hub/firefox_ios/views/funnel_retention_clients_table.view.lkml"
include: "//looker-hub/firefox_ios/views/fx_suggest.view.lkml"
include: "//looker-hub/firefox_ios/views/fx_suggest_table.view.lkml"
include: "//looker-hub/firefox_ios/views/growth_accounting.view.lkml"
include: "//looker-hub/firefox_ios/views/history_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/history_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/logins_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/logins_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/ltv_states_table.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_appstore_funnel.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_baseline.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_baseline_v2.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_events.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_firefox_ios_active_users_aggregates_view.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_firefox_ios_active_users_view.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_firefox_ios_engagement_view.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_firefox_ios_retention_view.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_funnel_retention.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_metrics.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_mobile_search_clients_engines_sources_daily.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_new_profile_activation.view.lkml"
include: "//looker-hub/firefox_ios/views/metric_definitions_special_onboarding_events.view.lkml"
include: "//looker-hub/firefox_ios/views/metrics.view.lkml"
include: "//looker-hub/firefox_ios/views/metrics_clients_daily_table.view.lkml"
include: "//looker-hub/firefox_ios/views/metrics_clients_last_seen_table.view.lkml"
include: "//looker-hub/firefox_ios/views/metrics_table.view.lkml"
include: "//looker-hub/firefox_ios/views/new_profile_activation_table.view.lkml"
include: "//looker-hub/firefox_ios/views/new_profile_clients_table.view.lkml"
include: "//looker-hub/firefox_ios/views/new_profiles_table.view.lkml"
include: "//looker-hub/firefox_ios/views/retention_clients_table.view.lkml"
include: "//looker-hub/firefox_ios/views/retention_table.view.lkml"
include: "//looker-hub/firefox_ios/views/sync.view.lkml"
include: "//looker-hub/firefox_ios/views/sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/tabs_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/tabs_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_baseline.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_baseline_table.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_bookmarks_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_bookmarks_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_clients_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_clients_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_credit_cards_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_credit_cards_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_history_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_history_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_logins_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_logins_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_rust_tabs_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_rust_tabs_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_tabs_sync.view.lkml"
include: "//looker-hub/firefox_ios/views/temp_tabs_sync_table.view.lkml"
include: "//looker-hub/firefox_ios/views/topsites_impression.view.lkml"
include: "//looker-hub/firefox_ios/views/topsites_impression_table.view.lkml"
include: "//looker-hub/firefox_ios/explores/*.explore.lkml"
include: "views/app_store_funnel_table.view.lkml"
include: "views/counters.view.lkml"
include: "views/growth.view.lkml"
include: "views/metrics_counters.view.lkml"
include: "views/usage.view.lkml"
include: "dashboards/*.dashboard"
include: "explores/*"
include: "datagroups/*"

explore: usage {
  always_filter: {
    filters: [
      submission_date: "26 weeks",
    ]
  }
  sql_always_where: submission_date >= "2020-01-01" ;;
}
explore: growth {
  always_filter: {
    filters: [
      submission_date: "26 weeks",
    ]
  }
  sql_always_where: submission_date >= "2020-01-01" ;;
}

# Counters
explore: metrics_sample {
  from: metrics
  sql_always_where: DATE(submission_timestamp) = DATE_SUB(CURRENT_DATE, INTERVAL 2 DAY)
    AND sample_id = 0;;
  hidden: yes
}

explore: column_field_paths {
  hidden: yes
}

explore: metrics_counters {
  hidden: yes
}

explore: counters {
  always_filter: {
    filters: [
      submission_date: "26 weeks",
      metric: "",
    ]
  }
}

explore: +client_counts {
  description: "Client counts across dimensions and cohorts."
  always_filter: {
    filters: [
      client_counts.submission_date: "4 weeks",
      client_counts.channel: "mozdata.org^_mozilla^_ios^_firefox.baseline^_clients^_daily",
    ]
  }
  query: cohort_analysis {
    description: "Client Counts of weekly cohorts over the past N days."
    dimensions: [
      client_counts.days_since_first_seen,
      client_counts.first_seen_week
    ]
    measures: [client_counts.client_count]
    pivots: [client_counts.first_seen_week]
    filters: [
      submission_date: "8 weeks",
      first_seen_date: "8 weeks",
      client_counts.have_completed_period: "yes",
    ]
    sorts: [
      client_counts.days_since_first_seen: asc
    ]
  }
  query: build_breakdown {
    description: "Number of clients per build."
    dimensions: [
      client_counts.submission_date,
      client_counts.app_build
    ]
    measures: [client_count]
    pivots: [app_build]
    filters: [
      submission_date: "28 days"
    ]
    sorts: [
      submission_date: asc
    ]
  }
}

explore: app_store_funnel_table {
  sql_always_where: ${period_filtered_measures} in ("this", "last");;
}

explore: +events_unnested {
  persist_with: events_unnested_v1_last_updated
}
